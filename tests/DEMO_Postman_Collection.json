{
  "info": {
    "name": "DID Credential Manager - Complete Demo",
    "description": "Complete demo flow for DID credential issuance, holding, and verification",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "issuer_url",
      "value": "http://localhost:5001",
      "type": "string"
    },
    {
      "key": "holder_url",
      "value": "http://localhost:5003",
      "type": "string"
    },
    {
      "key": "verifier_url",
      "value": "http://localhost:5002",
      "type": "string"
    },
    {
      "key": "issuer_did",
      "value": "",
      "type": "string"
    },
    {
      "key": "holder_did",
      "value": "",
      "type": "string"
    },
    {
      "key": "verifier_did",
      "value": "",
      "type": "string"
    },
    {
      "key": "credential_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "challenge_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Health Checks",
      "item": [
        {
          "name": "Issuer Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{issuer_url}}/health",
              "host": ["{{issuer_url}}"],
              "path": ["health"]
            }
          },
          "response": []
        },
        {
          "name": "Holder Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{holder_url}}/health",
              "host": ["{{holder_url}}"],
              "path": ["health"]
            }
          },
          "response": []
        },
        {
          "name": "Verifier Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{verifier_url}}/health",
              "host": ["{{verifier_url}}"],
              "path": ["health"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. Get DIDs",
      "item": [
        {
          "name": "Get Issuer DID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set(\"issuer_did\", jsonData.did);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{issuer_url}}/did",
              "host": ["{{issuer_url}}"],
              "path": ["did"]
            }
          },
          "response": []
        },
        {
          "name": "Get Holder DID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set(\"holder_did\", jsonData.did);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{holder_url}}/did",
              "host": ["{{holder_url}}"],
              "path": ["did"]
            }
          },
          "response": []
        },
        {
          "name": "Get Verifier DID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set(\"verifier_did\", jsonData.did);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{verifier_url}}/did",
              "host": ["{{verifier_url}}"],
              "path": ["did"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. Issue Credential",
      "item": [
        {
          "name": "Issue Drivers License to Holder",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set(\"issued_credential\", JSON.stringify(jsonData.credential));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"credentialSubject\": {\n    \"id\": \"{{holder_did}}\",\n    \"name\": \"Alice Smith\",\n    \"email\": \"alice@example.com\",\n    \"age\": 25,\n    \"licenseNumber\": \"DL123456\",\n    \"licenseClass\": \"C\",\n    \"dateOfBirth\": \"1999-05-15\",\n    \"address\": {\n      \"street\": \"123 Main St\",\n      \"city\": \"Springfield\",\n      \"state\": \"IL\",\n      \"zipCode\": \"62701\"\n    }\n  },\n  \"type\": [\"DriversLicense\"],\n  \"expirationDate\": \"2025-12-31T23:59:59Z\"\n}"
            },
            "url": {
              "raw": "{{issuer_url}}/credentials/issue",
              "host": ["{{issuer_url}}"],
              "path": ["credentials", "issue"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. Store Credential",
      "item": [
        {
          "name": "Store Credential in Holder Wallet",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set(\"credential_id\", jsonData.credentialId);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Note: You need to manually copy the credential from the previous request",
                  "// Or use this script to get it from the collection variable",
                  "var issuedCred = pm.collectionVariables.get(\"issued_credential\");",
                  "if (issuedCred) {",
                  "    pm.environment.set(\"credential_to_store\", issuedCred);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"credential\": {{issued_credential}}\n}"
            },
            "url": {
              "raw": "{{holder_url}}/credentials",
              "host": ["{{holder_url}}"],
              "path": ["credentials"]
            }
          },
          "response": []
        },
        {
          "name": "Get All Credentials",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{holder_url}}/credentials",
              "host": ["{{holder_url}}"],
              "path": ["credentials"]
            }
          },
          "response": []
        },
        {
          "name": "Get Specific Credential",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{holder_url}}/credentials/{{credential_id}}",
              "host": ["{{holder_url}}"],
              "path": ["credentials", "{{credential_id}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "5. Generate Challenge",
      "item": [
        {
          "name": "Generate Verification Challenge",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set(\"challenge_id\", jsonData.challenge.id);",
                  "pm.collectionVariables.set(\"challenge_value\", jsonData.challenge.value);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"holderDid\": \"{{holder_did}}\",\n  \"domain\": \"verifier.example.com\",\n  \"ttlMinutes\": 5\n}"
            },
            "url": {
              "raw": "{{verifier_url}}/challenges/generate",
              "host": ["{{verifier_url}}"],
              "path": ["challenges", "generate"]
            }
          },
          "response": []
        },
        {
          "name": "Get Challenge Details",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{verifier_url}}/challenges/{{challenge_id}}",
              "host": ["{{verifier_url}}"],
              "path": ["challenges", "{{challenge_id}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "6. Create Presentation",
      "item": [
        {
          "name": "Create Verifiable Presentation",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set(\"presentation\", JSON.stringify(jsonData.presentation));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"credentialIds\": [\"{{credential_id}}\"],\n  \"challenge\": \"{{challenge_value}}\",\n  \"domain\": \"verifier.example.com\"\n}"
            },
            "url": {
              "raw": "{{holder_url}}/presentations/create",
              "host": ["{{holder_url}}"],
              "path": ["presentations", "create"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "7. Verify Presentation",
      "item": [
        {
          "name": "Verify Presentation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"presentation\": {{presentation}},\n  \"challenge\": \"{{challenge_value}}\",\n  \"domain\": \"verifier.example.com\"\n}"
            },
            "url": {
              "raw": "{{verifier_url}}/verify/presentation",
              "host": ["{{verifier_url}}"],
              "path": ["verify", "presentation"]
            }
          },
          "response": []
        },
        {
          "name": "Verify Credential Directly",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"credential\": {{issued_credential}}\n}"
            },
            "url": {
              "raw": "{{verifier_url}}/verify/credential",
              "host": ["{{verifier_url}}"],
              "path": ["verify", "credential"]
            }
          },
          "response": []
        }
      ]
    }
  ]
}

